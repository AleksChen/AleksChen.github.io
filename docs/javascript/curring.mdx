---
title: æŸ¯é‡ŒåŒ–
---

import FeatureIcon from "@site/src/components/FeatureIcon";
import javascript from "@site/static/img/icon/javascript.png";

<FeatureIcon src={javascript} title="æŸ¯é‡ŒåŒ–" />

åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼ŒæŸ¯é‡ŒåŒ–ï¼ˆè‹±è¯­ï¼šCurrying ï¼‰ï¼Œåˆè¯‘ä¸ºå¡ç‘åŒ–æˆ–åŠ é‡ŒåŒ–ï¼Œæ˜¯æŠŠæ¥å—å¤šä¸ªå‚æ•°çš„å‡½æ•°å˜æ¢æˆæ¥å—ä¸€ä¸ªå•ä¸€å‚æ•°ï¼ˆæœ€åˆå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼‰çš„å‡½æ•°ï¼Œå¹¶ä¸”è¿”å›æ¥å—ä½™ä¸‹çš„å‚æ•°ï¼Œè€Œä¸”è¿”å›ç»“æœçš„æ–°å‡½æ•°çš„æŠ€æœ¯ã€‚
**ä¸»è¦ä½“ç°åœ¨å‡½æ•°é‡Œé¢è¿”å›å‡½æ•°**ã€‚å°±æ˜¯å°†å¤šå˜é‡å‡½æ•°æ‹†è§£ä¸ºå•å˜é‡ï¼ˆæˆ–éƒ¨åˆ†å˜é‡ï¼‰çš„å¤šä¸ªå‡½æ•°å¹¶ä¾æ¬¡è°ƒç”¨ã€‚ç›´ç™½ä¸€ç‚¹ï¼šåˆ©ç”¨é—­åŒ…ï¼Œå¯ä»¥å½¢æˆä¸€ä¸ªä¸é”€æ¯çš„ç§æœ‰ä½œç”¨åŸŸï¼ŒæŠŠé¢„å…ˆå¤„ç†çš„å†…å®¹éƒ½å­˜åœ¨è¿™ä¸ªä¸é”€æ¯çš„ä½œç”¨åŸŸé‡Œé¢ï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œä»¥åè¦æ‰§è¡Œçš„å°±æ˜¯è¿™ä¸ªå‡½æ•°ã€‚

ç›®çš„ï¼š

- ç®€åŒ–ä¼ å‚ï¼ŒåŒ–å¤šå‚æ•°å‡½æ•°ä¸ºå•å‚æ•°å‡½æ•°
- å•ä¸€èŒè´£åŸåˆ™ï¼šåœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­ï¼Œå¾€å¾€æ˜¯è®©ä¸€ä¸ªå‡½æ•°å¤„ç†çš„é—®é¢˜å°½å¯èƒ½å•ä¸€ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå‡½æ•°å¤„ç†å¤šä¸ªä»»åŠ¡ã€‚
- æé«˜ç»´æŠ¤æ€§ä»¥åŠé™ä½ä»£ç çš„é‡å¤æ€§

```javascript
const log = (a, b, c) => {
  console.log(a, b, c);
};
log(1, 2, 3); /// 1 2 3
let curryLog = curry(log);
curryLog(1)(2)(3); // 1 2 3
```

> **æœ¬è´¨ä¸Šæ˜¯é™ä½é€šç”¨æ€§ï¼Œæé«˜é€‚ç”¨æ€§ã€‚**

#### åœºæ™¯

åœ¨ react é¡¹ç›®ä¸­ä½¿ç”¨ antd è¡¨å•çš„æ—¶å€™ï¼Œé‡åˆ°ä¸€äº›è€é¡¹ç›®ï¼Œéœ€è¦æ ¡éªŒå¯†ç çš„å¼ºå¼±ã€æ ¡éªŒè¾“å…¥çš„è§„åˆ™ç­‰ï¼Œå¦‚æœæ¯æ¬¡éƒ½æ˜¯ä¼ æ­£åˆ™å’Œéœ€è¦æ ¡éªŒçš„å­—ç¬¦ä¸²ï¼Œæœ‰ç‚¹éº»çƒ¦ã€‚å¸Œæœ›çš„æ•ˆæœï¼šé€šè¿‡ç»™ä¸€ä¸ªå‡½æ•°ä¼ æ­£åˆ™å‚æ•°ï¼Œç„¶åå¾—åˆ°ä¸€ä¸ªå‡½æ•°ï¼Œåç»­åªéœ€è¦å°†å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°å³å¯ï¼Œä¸éœ€è¦é‡å¤ä¼ å…¥æ­£åˆ™ã€‚

```javascript
const testFn = curryingFn(/www.abc.com/g);

const result1 = testFn("abc"); // false

const result2 = testFn("www.abc.com"); // true

const addFn = (x, y, z) => {
  return x + y + z;
};

const addResultFn = addFn(1, 2, 3);

// å°†ä¸Šè¿°è¿‡ç¨‹è½¬åŒ–ä¸ºä¸‹é¢çš„å®ç°è¿‡ç¨‹å°±æ˜¯æŸ¯é‡ŒåŒ–
const simplifySumFn = (x) => (y) => (z) => {
  return x + y + z;
};

const sum = sumFn(1)(2)(3);
```

åŒ–å¤šå‚æ•°ä¸ºå•ä¸€å‚æ•°

```javascript
// ç¤ºæ„è€Œå·²
function ajax(type, url, data) {
  var xhr = new XMLHttpRequest();
  xhr.open(type, url, true);
  xhr.send(data);
}

// è™½ç„¶ ajax è¿™ä¸ªå‡½æ•°éå¸¸é€šç”¨ï¼Œä½†åœ¨é‡å¤è°ƒç”¨çš„æ—¶å€™å‚æ•°å†—ä½™
ajax("POST", "www.test.com", "name=kevin");
ajax("POST", "www.test2.com", "name=kevin");
ajax("POST", "www.test3.com", "name=kevin");

// åˆ©ç”¨ curry
var ajaxCurry = curry(ajax);

// ä»¥ POST ç±»å‹è¯·æ±‚æ•°æ®
var post = ajaxCurry("POST");
post("www.test.com", "name=kevin");

// ä»¥ POST ç±»å‹è¯·æ±‚æ¥è‡ªäº www.test.com çš„æ•°æ®
var postFromTest = post("www.test.com");
postFromTest("name=kevin");
```

ä¸¾ä¸ªä¾‹å­ï¼š
æ¯”å¦‚æˆ‘ä»¬æœ‰è¿™æ ·ä¸€æ®µæ•°æ®ï¼š

```javascript
var person = [{ name: "kevin" }, { name: "daisy" }];
```

å¦‚æœæˆ‘ä»¬è¦è·å–æ‰€æœ‰çš„ name å€¼ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼š

```javascript
var name = person.map(function (item) {
  return item.name;
});
```

ä¸è¿‡å¦‚æœæˆ‘ä»¬æœ‰ curry å‡½æ•°ï¼š

```javascript
var prop = curry(function (key, obj) {
  return obj[key];
});
var name = person.map(prop("name"));
```

æˆ‘ä»¬ä¸ºäº†è·å– name å±æ€§è¿˜è¦å†ç¼–å†™ä¸€ä¸ª prop å‡½æ•°ï¼Œæ˜¯ä¸æ˜¯åˆéº»çƒ¦äº†äº›ï¼Ÿ
ä½†æ˜¯è¦æ³¨æ„ï¼Œprop å‡½æ•°ç¼–å†™ä¸€æ¬¡åï¼Œä»¥åå¯ä»¥å¤šæ¬¡ä½¿ç”¨ï¼Œå®é™…ä¸Šä»£ç ä»åŸæœ¬çš„ä¸‰è¡Œç²¾ç®€æˆäº†ä¸€è¡Œï¼Œè€Œä¸”ä½ çœ‹ä»£ç æ˜¯ä¸æ˜¯æ›´åŠ æ˜“æ‡‚äº†ï¼Ÿ
`person.map(prop('name'))` å°±å¥½åƒç›´ç™½çš„å‘Šè¯‰ä½ ï¼šperson å¯¹è±¡éå†(map)è·å–(prop) name å±æ€§ã€‚

#### å®ç°

å‚æ•°ä¸ªæ•°éƒ½ä¸èƒ½è¶…è¿‡å‡½æ•°çš„è¦æ±‚ï¼Œä¸ç„¶ä¼šæŠ¥é”™

##### ç¬¬ä¸€ç‰ˆ

```javascript
var curry = function (fn) {
  var args = [].slice.call(arguments, 1); // args æ˜¯ curry æ—¶é™¤å‡½æ•° fn å¤–çš„å‚æ•°
  return function () {
    var newArgs = args.concat([].slice.call(arguments)); // æ­¤å¤„çš„ arguments æ˜¯æŸ¯é‡ŒåŒ–äº§ç‰©å‡½æ•°åœ¨æ‰§è¡Œæ—¶æ¥æ”¶çš„å‡½æ•°ã€‚ä¸æŸ¯é‡ŒåŒ–æ—¶çš„ args è¿›è¡Œæ‹¼æ¥ï¼Œä¼ é€’ç»™ fn æ‰§è¡Œ
    return fn.apply(this, newArgs);
  };
};

function add(a, b) {
  return a + b;
}

var addCurry = curry(add, 1, 2);
addCurry(); // 3
//æˆ–è€…
var addCurry = curry(add, 1);
addCurry(2); // 3
//æˆ–è€…
var addCurry = curry(add);
addCurry(1, 2); // 3
```

##### ç¬¬äºŒç‰ˆ

```javascript
function sub_curry(fn) {
  var args = [].slice.call(arguments, 1);
  return function () {
    return fn.apply(this, args.concat([].slice.call(arguments)));
  };
}

function curry(fn, length) {
  length = length || fn.length; // è®°å½•æŸ¯é‡ŒåŒ–å‡½æ•°çš„å‚æ•°ä¸ªæ•°
  var slice = Array.prototype.slice;
  return function () {
    if (arguments.length < length) {
      // å¦‚æœæŸ¯é‡ŒåŒ–å‡½æ•°å·²æ¥æ”¶çš„å‚æ•°æ•°å°äºéœ€è¦å‚æ•°ä¸ªæ•°ï¼Œåˆ™é€’å½’æ‰§è¡Œï¼Œç»§ç»­ç­‰å¾…
      var combined = [fn].concat(slice.call(arguments)); // å°†å‚æ•°è¿›è¡Œæ‹¼æ¥ä¿ç•™
      return curry(sub_curry.apply(this, combined), length - arguments.length); // é€’å½’æ‰§è¡Œï¼Œæ›´æ–°å‰©ä½™æ‰€éœ€å‚æ•°ä¸ªæ•°
    } else {
      return fn.apply(this, arguments); // æ‰€éœ€å‚æ•°å·²è¶³å¤Ÿï¼Œå°†æ‰€æœ‰å‚æ•°ä¼ é€’ç»™ fn æ‰§è¡Œ
    }
  };
}

// éªŒè¯
var fn = curry(function (a, b, c) {
  return [a, b, c];
});

fn("a", "b", "c"); // ["a", "b", "c"]
fn("a", "b")("c"); // ["a", "b", "c"]
fn("a")("b")("c"); // ["a", "b", "c"]
fn("a")("b", "c"); // ["a", "b", "c"]
```

> sub_curry çš„ä½œç”¨å°±æ˜¯ç”¨å‡½æ•°åŒ…è£¹åŸå‡½æ•°ï¼Œç„¶åç»™åŸå‡½æ•°ä¼ å…¥ä¹‹å‰çš„å‚æ•°ï¼Œå½“æ‰§è¡Œ fn0(...)(...) çš„æ—¶å€™ï¼Œæ‰§è¡ŒåŒ…è£¹å‡½æ•°ï¼Œè¿”å›åŸå‡½æ•°ï¼Œç„¶åå†è°ƒç”¨ sub_curry å†åŒ…è£¹åŸå‡½æ•°ï¼Œç„¶åå°†æ–°çš„å‚æ•°æ··åˆæ—§çš„å‚æ•°å†ä¼ å…¥åŸå‡½æ•°ï¼Œç›´åˆ°å‡½æ•°å‚æ•°çš„æ•°ç›®è¾¾åˆ°è¦æ±‚ä¸ºæ­¢ã€‚

```javascript
const selfCurryFn = (fn) => {
 Â const fnLen = fn.length; Â // fn æ¥æ”¶çš„å‚æ•°
 Â function curry(...args) {
 Â  Â const argLen = args.length; // curry æ¥æ”¶çš„å‚æ•°
 Â  Â if(argLen >= fnLen) {
 Â  Â  Â return fn.apply(this, args); // å¦‚æœå¤–é¢ç»‘å®š this çš„è¯ï¼Œç›´æ¥ç»‘å®šåˆ°fnä¸Š
 Â   } else {
 Â  Â  Â // å‚æ•°ä¸ªæ•°æ²¡æœ‰è¾¾åˆ°æ—¶ç»§ç»­æ¥æ”¶å‰©ä½™çš„å‚æ•°
 Â  Â  Â function otherCurry(...args2) {
 Â  Â  Â  Â return curry.apply(this, args.concat(args2))
 Â  Â   }
 Â  Â  Â return otherCurry;
 Â   }
  }
 Â return curry;
}
â€¢
const selfAddFn = (x, y, z) => {
 Â return x + y + z;
}
â€¢
const selfSum = selfCurryFn(selfAddFn);
â€¢
console.log("ğŸš€ ~ file: preview.html ~ line 80 ~ selfSum(1, 2, 3)", selfSum(1, 2, 3))
console.log("ğŸš€ ~ file: preview.html ~ line 81 ~ selfSum(1, 2)(3)", selfSum(1, 2)(3))
console.log("ğŸš€ ~ file: preview.html ~ line 81 ~ selfSum(1, 2)(3)", selfSum(1)(2)(3))
```

#### åº”ç”¨

##### Redux ä¸­é—´ä»¶

```javascript
export default function applyMiddleware(...middlewares) {
  return (createStore) =>
    (...args) => {
      // åˆ©ç”¨ä¼ å…¥çš„ createStore å’Œ reducer å’Œåˆ›å»ºä¸€ä¸ª store
      const store = createStore(...args);
      let dispatch = () => {
        throw new Error();
      };
      const middlewareAPI = {
        getState: store.getState,
        dispatch: (...args) => dispatch(...args),
      }; // middlewareAPI è¿™ä¸ªå‚æ•°åˆ†åˆ«æ‰§è¡Œä¸€é
      const chain = middlewares.map((middleware) => middleware(middlewareAPI)); // ç»„è£…æˆä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œå³æ–°çš„ dispatch
      dispatch = compose(...chain)(store.dispatch);
      return {
        ...store,
        dispatch,
      };
    };
}
```

##### å‡½æ•°çš„ç»„åˆæ¨¡å¼

èƒŒæ™¯ï¼š

- æˆ‘ä»¬å¯¹æŸä¸€ä¸ªå‡½æ•°è¿›è¡Œè°ƒç”¨ï¼Œæ‰§è¡Œ fn1ã€fn2ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°æ˜¯ä¾æ¬¡æ‰§è¡Œ
- æ¯æ¬¡æˆ‘ä»¬éƒ½éœ€è¦è¿›è¡Œä¸¤ä¸ªå‡½æ•°çš„è°ƒç”¨ï¼Œæ“ä½œä¸Šå°±ä¼šæ˜¾ç¤ºçš„é‡å¤
- é‚£ä¹ˆæˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥å°† fn1ã€fn2 ç»„åˆèµ·æ¥ï¼Œè‡ªåŠ¨ä¸€æ¬¡è°ƒç”¨å‘¢ï¼Ÿ å…¶å®å®ç°ä¸Šè¿°çš„è¿‡ç¨‹å°±æ˜¯ç»„åˆå‡½æ•°ï¼ˆcompose functionï¼‰ã€‚

```javascript
// å¸¸è§„å†™æ³•
function compose(fn1, fn2) {
  return function (num) {
    return fn2(fn1(num));
  };
}

const fn1 = (num) => {
  return num + 10;
};

const fn2 = (num) => {
  return num * num;
};

const a = 10;
const newFn = compose(fn1, fn2);
const result = newFn(a);

// æŸ¯é‡ŒåŒ–
function createCompose(...fns) {
  const length = fns.length;
  for (let i = 0; i < length; i++) {
    if (typeof fns[i] !== "function") {
      throw new TypeError("arguments is not function");
    }
  }
  function compose(...args) {
    let index = 0;
    let result = length ? fns[index].apply(this, args) : args;
    while (++index < length) {
      result = fns[index].call(this, result);
    }
  }
  return compose;
}
```

#### èµ„æ–™

- [https://en.m.wikipedia.org/wiki/Currying](https://en.m.wikipedia.org/wiki/Currying)
- [https://juejin.cn/post/7181983157544042557](https://juejin.cn/post/7181983157544042557)
- [https://github.com/mqyqingfeng/Blog/issues/42](https://github.com/mqyqingfeng/Blog/issues/42)
